package main

import (
	"fmt"
	"net/url"
	"strconv"

	"fyne.io/fyne/v2"
	"fyne.io/fyne/v2/app"
	"fyne.io/fyne/v2/container"
	"fyne.io/fyne/v2/theme"
	"fyne.io/fyne/v2/widget"
)

func main() {
	//создание нового приложения
	calculator := app.New()

	//создание графического окна для приложения
	window := calculator.NewWindow("calculator")
	//регулировка размера окна
	window.Resize(fyne.NewSize(700, 450))

	//ссылки
	url_1, _ := url.Parse("https://www.desmos.com/scientific")
	link_1 := widget.NewHyperlink("more advanced calculator", url_1)
	url_2, _ := url.Parse("https://t.me/dvrkv")
	link_2 := widget.NewHyperlink("designed by @dvrkv", url_2)

	//картинки

	//поля ввода
	entry_1 := widget.NewEntry()
	entry_2 := widget.NewEntry()

	//подсказки ввода
	entry_1.SetPlaceHolder("Введите первое число...")
	entry_2.SetPlaceHolder("Введите второе число...")

	//результат вычислений
	answer := widget.NewLabel("")

	//кнопки
	button_addition := widget.NewButton("+", func() {
		//конвертация в float64 и получение значений из полей ввода
		num_1, err_1 := strconv.ParseFloat(entry_1.Text, 64)
		num_2, err_2 := strconv.ParseFloat(entry_2.Text, 64)

		if err_1 != nil || err_2 != nil {
			answer.SetText("ОШИБКА ВВОДА!")
		} else {
			addition := num_1 + num_2

			//вывод ответа и конвертация в string
			answer.SetText(fmt.Sprintf("%.2f", addition))
		}
	})
	button_subtraction := widget.NewButton("-", func() {
		//конвертация в float64 и получение значений из полей ввода
		num_1, err_1 := strconv.ParseFloat(entry_1.Text, 64)
		num_2, err_2 := strconv.ParseFloat(entry_2.Text, 64)

		if err_1 != nil || err_2 != nil {
			answer.SetText("ОШИБКА ВВОДА!")
		} else {
			subtraction := num_1 - num_2

			//вывод ответа и конвертация в string
			answer.SetText(fmt.Sprintf("%.2f", subtraction))
		}
	})
	button_multiplication := widget.NewButton("х", func() {
		//конвертация в float64 и получение значений из полей ввода
		num_1, err_1 := strconv.ParseFloat(entry_1.Text, 64)
		num_2, err_2 := strconv.ParseFloat(entry_2.Text, 64)

		if err_1 != nil || err_2 != nil {
			answer.SetText("ОШИБКА ВВОДА!")
		} else {
			multiplication := num_1 * num_2

			//вывод ответа и конвертация в string
			answer.SetText(fmt.Sprintf("%.2f", multiplication))
		}
	})
	button_division := widget.NewButton("/", func() {
		//конвертация в float64 и получение значений из полей ввода
		num_1, err_1 := strconv.ParseFloat(entry_1.Text, 64)
		num_2, err_2 := strconv.ParseFloat(entry_2.Text, 64)

		if err_1 != nil || err_2 != nil {
			answer.SetText("ОШИБКА ВВОДА!")
		} else if num_2 == 0 {
			answer.SetText("НА 0 ДЕЛИТЬ НЕЛЬЗЯ!")
		} else {
			division := num_1 / num_2

			//вывод ответа и конвертация в string
			answer.SetText(fmt.Sprintf("%.2f", division))
		}
	})
	button_dark := widget.NewButton("Темная", func() {
		calculator.Settings().SetTheme(theme.DarkTheme())
	})
	button_light := widget.NewButton("Светлая", func() {
		calculator.Settings().SetTheme(theme.LightTheme())
	})

	//коробки
	box_1 := container.NewVBox(
		entry_1,
		entry_2,
	)
	box_2 := container.NewHBox(
		button_addition,
		button_subtraction,
		button_multiplication,
		button_division,
	)
	box_3 := container.NewHBox(
		button_dark,
		button_light,
	)
	box_4 := container.NewHBox(
		link_1,
		link_2,
	)
	box_5 := container.NewHBox(
		answer,
	)

	//карточки
	card_calculator := widget.NewCard("Калькулятор", "", box_1)
	card_operations := widget.NewCard("", "", box_2)
	card_answer := widget.NewCard("Результат", "", box_5)
	card_theme := widget.NewCard("Тема", "", box_3)
	card_links := widget.NewCard("Ссылки", "", box_4)

	//содержимое окна приложения

	window.SetContent(container.NewVBox(
		card_calculator,
		card_operations,
		card_answer,
		card_theme,
		card_links,
	))

	//запуск приложения
	window.ShowAndRun()
}
